# 基于特征加密的MAC身份认证方案

## 项目概述

本项目针对自组织、弱连接的无线网络场景中"终端接入困难、身份易被重放/伪造、长期行为易被跟踪"三类突出风险，提出了一套基于物理层特征的链路层身份认证方案。

该方案采用设备通信信道与射频硬件的固有差异作为身份识别的"内生指纹"，通过特征密钥生成、认证方法、特征周期轮换一体化研究，实现了抗仿造、抗重放、抗长期跟踪的安全接入控制。

## 应用场景

本认证方案特别适用于以下场景：

- **自组织网络**：节点动态加入和离开，缺乏固定基础设施
- **弱连接环境**：链路不稳定、往返时延不可控
- **资源受限设备**：边缘节点算力和存储有限
- **高安全需求**：需要抵御MAC克隆、重放攻击、长期跟踪等威胁

典型应用包括：无人机集群通信、物联网边缘接入、应急通信网络、车联网等。

## 技术架构

本方案采用两种认证模式，如图13所示：

1. **模式一**：通过物理层传递的射频指纹结果，与MAC地址结合，实现快速轻量化认证
2. **模式二**：根据信道特征的MAC身份认证，基于信道特征的周期性变化，实现防伪造的能力

整体技术架构如图14所示，包含三个核心研究内容，形成"特征 → 密钥 → 认证 → 周期演进"的闭环。

## 核心研究内容

### [3.1 研究基于特征的加密算法](./3.1.md)

**定位**：连接物理层特征与链路层认证的"中间引擎"

**核心功能**：
- 将含噪的设备/信道特征稳定映射为高熵比特串
- 派生特征密钥（用于认证标签）和会话密钥（用于数据保护）
- 实现密钥与MAC地址、时间窗等上下文强绑定

**关键技术**：
1. **特征预处理与规整**：支持CSI和RFF两种特征输入路径
2. **稳健量化与投票**：通过多帧投票抵抗噪声和衰落
3. **纠错与模糊提取**：采用码偏移式模糊提取器保证密钥稳定重构
4. **上下文绑定与密钥派生**：使用HKDF将密钥与时间窗、MAC等绑定

**输入输出**：
- 输入：特征向量X、随机数nonce、上下文信息（MAC、epoch等）
- 输出：稳定特征串S、特征密钥K、会话密钥Ks、一致性摘要digest

### [3.2 研究基于特征的认证方法（两种模式）](./3.2.md)

**定位**：新接入节点在链路层证明"自己是登记过的那台设备"

**模式一：基于射频指纹（RFF）的快速轻量认证**
- **特点**：毫秒级放行、计算开销低
- **适用场景**：接入频繁、对时延敏感的场景（如高密度物联网、无人机集群）
- **工作流程**：
  1. 物理层完成RFF匹配，上报判定结果
  2. 链路层根据结果快速决策
  3. 通过后签发短期令牌Token_fast

**模式二：基于特征加密的强认证方案**
- **特点**：单报文完成强认证、抗重放抗克隆
- **适用场景**：高安全需求场景
- **工作流程**：
  1. 设备端调用3.3.1生成特征密钥K和会话密钥Ks
  2. 生成伪名和认证标签Tag，构造AuthReq
  3. 验证端重构密钥、校验Tag
  4. 通过后签发准入令牌MAT

**两种模式对比**：

| 维度 | 模式一（RFF快速认证） | 模式二（特征加密强认证） |
|------|----------------------|-------------------------|
| 认证时延 | 毫秒级 | 单次往返（秒级） |
| 安全强度 | 中等（物理层判定） | 高（密码学验证） |
| 计算开销 | 极低 | 低 |
| 适用场景 | 快速筛查、轻量接入 | 高安全需求、长期会话 |
| 抗攻击能力 | 基础（依赖RFF） | 强（抗重放、抗克隆、抗跟踪） |

### [3.3 基于特征的周期变化同步机制](./3.3.md)

**定位**：为特征加密和认证提供分布式环境下的同步基础

**核心机制**：

#### 1. 时间窗同步与容错
- 簇首周期性广播同步信标（epoch、导频计划、特征配置）
- 多窗容忍策略：接受相邻2-3个epoch的请求，吸收时钟偏差
- 短暂双钥策略：新旧epoch交替时同时保留新旧密钥

#### 2. 特征参数同步与子空间轮换
- 统一特征采集配置（导频时隙、子载波子集、量化门限）
- 周期性轮换子空间，抵御历史特征重放攻击
- 一致性摘要digest校验，确保双方配置对齐

#### 3. 伪名、会话密钥与令牌的统一轮换
- 每个epoch内派生新的伪名DevPseudo、特征密钥K、会话密钥Ks
- MAT准入令牌与epoch绑定，过期自动失效
- 实现"按窗授权、过期即换"，降低长期跟踪风险

#### 4. 失步与重同步处理
- 本地时钟平滑推进：簇首不可达时按上一轮配置继续运行
- epoch偏差检测：超出范围则拒绝并要求重同步
- 强制重同步：收到新信标后立即对齐并刷新所有凭证

## 关键问题与解决方案

### 问题1：信道特征在噪声环境下的"可再生"与"难仿造"矛盾

**挑战**：
- 实际信道存在随机衰落与噪声，同一设备多次测量结果不完全一致
- 特征到密钥的转换过程如果暴露过多细节，可能被攻击者建模仿造

**解决方案**（3.3.1）：
- 采用稳健量化与多帧投票，提高特征一致性
- 使用模糊提取器进行纠错，保证密钥稳定重构
- 辅助数据仅在验证端安全存储，不在链路中明文传播
- 周期性轮换特征子空间（3.3.3），降低被建模风险

### 问题2：单报文完成低时延安全认证

**挑战**：
- 自组织网络链路不稳定，多轮交互认证故障率高
- 需要在单次报文中携带足够的认证信息，抵御重放、调包等攻击
- 算法复杂度需控制在资源受限设备可承受范围

**解决方案**（3.3.2模式二）：
- 在首个接入报文AuthReq中完成挑战-响应式认证
- 认证标签Tag绑定SrcMAC/DstMAC/epoch/nonce/seq，实现多维度防护
- 采用轻量级哈希和HKDF原语，计算开销低
- 提供快速认证模式（模式一）作为补充，适应不同场景需求

### 问题3：节点身份/密钥周期轮换与分布式吊销治理

**挑战**：
- 伪名和会话密钥长期不变会带来跟踪和凭证滥用风险
- 多接入点环境下需要快速同步吊销信息
- 需要容忍时钟与状态不一致，避免频繁误拒

**解决方案**（3.3.3）：
- 按时间窗自动轮换伪名、特征密钥、会话密钥和MAT令牌
- 通过簇首信标广播实现轻量级同步
- 多窗容忍和短暂双钥策略吸收时钟偏差
- 滑动窗口机制防止重放，迟滞策略降低误拒

## 性能指标

### 核心指标：抗仿造误受率

**定义**：在预设攻击模型下（包括MAC克隆＋重放＋近邻信道模仿＋PUF建模），未注册设备被误判为合法并获得准入令牌的比例。

**验收目标**：≤ 1%

### 指标先进性分析

相较传统机制（白名单、预共享密钥、EAP等）的优势：

1. **身份根不可克隆**：将身份根从可复制的MAC地址，提升为不可克隆的物理特征
2. **时间窗绑定**：密钥约束在特定终端和时间窗口内，历史报文无法重放
3. **首包认证**：单报文完成挑战-响应式认证，降低交互开销和故障率
4. **周期轮换**：通过哈希链与伪名/会话密钥周期轮换，缩短凭证可利用时间
5. **容错机制**：滑动窗口容错在控制误拒率的同时，将攻击成功概率控制在1%以下

## 技术创新点

1. **物理层与链路层融合认证**：首次将CSI/RFF特征与MAC身份认证深度融合
2. **双模式自适应认证**：提供快速和强认证两种模式，适应不同场景需求
3. **轻量级密钥派生**：设计了从特征到密钥的完整流水线，计算开销低
4. **分布式周期同步**：无需全局时钟，通过信标和容错策略实现分布式同步
5. **多维度安全绑定**：将密钥与MAC、时间窗、序号等多维度绑定，形成立体防护

## 系统工作流程

### 注册阶段

1. 设备在安全环境下完成注册
2. 采集物理层特征（CSI或RFF）
3. 生成模糊提取器辅助数据P
4. 将设备ID、特征配置、辅助数据存储到验证端

### 接入认证阶段（模式二示例）

1. **时间窗同步**：设备接收簇首信标，获取当前epoch和特征配置
2. **特征采集**：按配置采集M=6帧特征样本
3. **密钥生成**：调用3.3.1算法，生成S、K、Ks、digest
4. **构造认证请求**：
   - 生成伪名DevPseudo
   - 计算认证标签Tag
   - 构造AuthReq报文
5. **验证端处理**：
   - 定位设备注册信息
   - 重构特征密钥K′
   - 校验digest一致性
   - 校验Tag
6. **签发令牌**：验证通过后签发MAT和Ks
7. **数据面通信**：使用Ks加密后续数据帧

### 周期轮换阶段

1. 时间窗推进到新的epoch
2. 旧MAT、旧Ks、旧伪名自动失效
3. 设备重新发起认证，生成新凭证
4. 验证端更新状态，回收旧令牌

## 文档结构

```
.
├── README.md           # 本文件，项目整体介绍和逻辑梳理
├── prd.docx           # 原始需求文档
├── 3.1.md             # 研究内容一：基于特征的加密算法
├── 3.2.md             # 研究内容二：基于特征的认证方法（两种模式）
└── 3.3.md             # 研究内容三：基于特征的周期变化同步机制
```

## 阅读建议

### 快速了解

如果您想快速了解本方案，建议按以下顺序阅读：

1. **README.md（本文件）**：了解项目背景、整体架构和核心创新点
2. **3.2.md 的"概述"和"模式对比"部分**：理解两种认证模式的差异和适用场景
3. **技术架构图**（图13、图14）：建立整体认知

### 深入研究

如果您需要深入理解技术细节，建议按以下顺序阅读：

1. **README.md**：建立整体框架
2. **3.1.md**：理解"特征→密钥"的转换过程，这是整个方案的基础
3. **3.2.md**：理解两种认证模式的具体实现和工作流程
4. **3.3.md**：理解分布式环境下的同步和轮换机制
5. **prd.docx**：查看原始需求文档中的更多细节和公式推导

### 技术实现

如果您准备实现本方案，建议重点关注：

1. **3.1.md 的"算法流程细节"**：了解四步密钥派生流程
2. **3.2.md 的"设备侧认证流程"和"验证端认证流程"**：了解报文格式和处理逻辑
3. **3.3.md 的"失步与重同步处理"**：了解容错机制设计

## 依赖技术

### 密码学原语

- **BLAKE3**：通用哈希函数，用于密钥派生和标签计算
- **HKDF**：密钥派生函数（基于HMAC）
- **BCH码**：纠错码，用于模糊提取器
- **Ascon-128a**：轻量级AEAD算法，用于数据面加密

### 物理层技术

- **CSI（信道状态信息）**：基于OFDM导频估计的信道特征
- **RFF（射频指纹）**：基于硬件缺陷的射频特征（CFO、SCO、I/Q失衡等）
- **模糊提取器**：从含噪生物特征/物理特征中提取稳定密钥的密码学工具

### 网络技术

- **TDD（时分双工）**：用于信道互易性测量
- **802.11/以太网**：链路层协议栈
- **簇首选举**：分布式系统中的领导者选举机制

## 未来工作

1. **性能优化**：进一步降低特征处理和密钥派生的计算延迟
2. **多模态融合**：结合CSI和RFF特征，提升鲁棒性
3. **机器学习增强**：利用深度学习优化特征提取和匹配
4. **标准化推进**：推动相关技术纳入IEEE 802.11、802.15等标准
5. **实际部署验证**：在真实无线网络环境中验证方案有效性

## 参考资料

- IEEE 802.11无线局域网标准
- 模糊提取器相关密码学理论
- 物理层安全与射频指纹识别技术
- 分布式系统时钟同步机制

---

**项目状态**：设计完成，待实现与验证

**最后更新**：2025年
