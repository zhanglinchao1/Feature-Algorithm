# 3.1 算法正确性分析报告

## 分析目标

检查`requirements.md`（原3.1.md）中算法的：
1. 逻辑正确性
2. 参数完整性
3. 边界清晰度
4. 实现可行性

## 算法流程回顾

整个算法分为四个步骤：
1. 特征预处理与规整
2. 稳健量化与多帧投票
3. 纠错与模糊提取
4. 上下文绑定与密钥派生

## 问题分析

### ✅ 逻辑正确性

**结论：整体逻辑正确**

算法流程符合"含噪特征 → 稳定比特串 → 密钥派生"的标准模式：
- 预处理消除环境噪声
- 量化+投票提高稳定性
- 模糊提取器纠错
- HKDF安全派生密钥

这是学术界和工业界广泛认可的方法。

### ❌ 参数边界不清晰

**发现的问题**：

#### 1. 特征维度参数缺失
- **问题**："从个子载波中选取高SNR子集" - 没有明确数量
- **影响**：无法确定特征向量长度
- **建议**：明确定义子载波数量（如64个子载波选32个）

#### 2. 比特串长度未定义
- **问题**："目标 bit" - 没有具体数值
- **影响**：无法设计BCH纠错码参数
- **建议**：明确定义目标长度（如256 bits）

#### 3. 量化门限计算方法缺失
- **问题**：θ_L和θ_H没有定义如何计算
- **影响**：无法实现量化逻辑
- **建议**：定义门限计算方法（如基于统计分位数）

#### 4. BCH编码参数未指定
- **问题**：BCH(n,k,t)参数、块数J都未定义
- **影响**：无法实现模糊提取器
- **建议**：明确BCH参数（如BCH(255,131,18)）

#### 5. 帧数M虽已指定为6，但缺少投票规则
- **问题**：多数投票的具体规则未定义
- **影响**：边界情况处理不明确
- **建议**：明确投票规则（如≥4票通过，≤2票擦除）

### ⚠️ 实现细节不足

#### 1. CSI特征提取公式不完整
- **问题**：只描述了步骤，没有给出具体公式
- **影响**：不同实现可能不一致
- **建议**：补充完整的数学公式

#### 2. RFF特征标准化方法未定义
- **问题**：标准化方式不明确
- **影响**：可能导致特征不稳定
- **建议**：定义标准化公式（如Z-score）

### ✅ 密钥派生部分完整

**正确之处**：
- HKDF使用规范
- 上下文绑定清晰
- 输出长度明确（32字节）

## 修正建议

### 优先级1：必须修正的参数

| 参数 | 当前状态 | 建议值 | 说明 |
|------|---------|--------|------|
| N_subcarrier | 未定义 | 64 | OFDM子载波总数 |
| N_selected | 未定义 | 32 | 选择的高SNR子载波数 |
| D_feature | 未定义 | 64 | 特征总维度（幅度32+相位32） |
| L_bits | 未定义 | 256 | 目标比特串长度 |
| M_frames | 已定义=6 | 6 | 采样帧数 |
| V_threshold | 未定义 | 4 | 投票通过阈值（≥4票） |
| BCH_n | 未定义 | 255 | BCH码字长度 |
| BCH_k | 未定义 | 131 | BCH消息长度 |
| BCH_t | 未定义 | 18 | BCH纠错能力 |
| J_blocks | 未定义 | 2 | BCH分块数（256/131≈2） |

### 优先级2：需要明确的计算方法

#### 量化门限计算
```python
# 建议方法：基于统计分位数
θ_L = percentile(X, 25)  # 下四分位数
θ_H = percentile(X, 75)  # 上四分位数
```

#### 投票规则
```python
# 建议规则
if count(1) >= 4: bit = 1
elif count(0) >= 4: bit = 0
else: bit = erasure (丢弃该维度)
```

#### SNR排序
```python
# 建议方法
SNR[k] = mean(|H[k]|^2) / noise_variance
selected_indices = argsort(SNR)[:N_selected]
```

### 优先级3：需要补充的公式

#### CSI特征提取
```
# 幅度差分特征
A[d] = |H[k_d]| - |H[k_{d-1}]|, d=1..31

# 相位差分特征
P[d] = angle(H[k_d]) - angle(H[k_{d-1}]), d=1..31

# 拼接
Z = [A[1],...,A[31], P[1],...,P[31]]  # 62维
```

#### RFF特征标准化
```
# Z-score标准化
X_normalized[i] = (X[i] - mean(X)) / std(X)
```

## 修正后的算法规范

建议创建`algorithm_spec.md`文档，包含：
1. 所有参数的明确定义和默认值
2. 所有计算步骤的完整公式
3. 边界情况的处理规则
4. 输入输出的数据类型和范围

## 下一步工作

1. 创建`parameter_config.md`，列出所有参数
2. 创建`algorithm_spec.md`，补充完整公式
3. 更新`requirements.md`，消除模糊描述
4. 基于明确的规范开始编码

## 总结

| 评估维度 | 评分 | 说明 |
|---------|------|------|
| 逻辑正确性 | ✅ 优秀 | 符合学术标准，流程合理 |
| 参数完整性 | ❌ 不足 | 关键参数缺失，需补充 |
| 边界清晰度 | ❌ 不足 | 多处边界未定义 |
| 实现可行性 | ⚠️ 中等 | 补充参数后可实现 |

**总体结论**：算法思路正确，但需要补充明确的参数定义和计算公式后才能开始编码实现。
