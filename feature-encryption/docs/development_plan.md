# 开发计划

## 开发阶段划分

### 阶段1：环境准备与依赖安装 ✅
- [x] 创建项目结构
- [x] 编写需求文档分析
- [x] 定义参数配置
- [x] 编写算法规范

### 阶段2：核心模块实现 🔄
- [ ] 实现配置管理模块
- [ ] 实现特征处理模块
- [ ] 实现量化投票模块
- [ ] 实现模糊提取器模块
- [ ] 实现密钥派生模块
- [ ] 实现主流程整合

### 阶段3：测试与验证 ⏳
- [ ] 编写单元测试
- [ ] 编写集成测试
- [ ] 性能测试
- [ ] 安全性测试

### 阶段4：优化与审查 ⏳
- [ ] 代码审查
- [ ] 性能优化
- [ ] 文档完善
- [ ] 提交代码

## 详细任务分解

### Task 2.1: 配置管理模块

**文件**：`src/config.py`

**功能**：
- 定义所有参数的默认值
- 提供配置验证功能
- 支持从文件加载配置
- 支持配置导出

**实现要点**：
```python
class FeatureEncryptionConfig:
    - DEFAULT_CONFIG字典
    - validate()方法
    - load_from_file()方法
    - to_dict()方法
```

**预计时间**：2小时

### Task 2.2: 特征处理模块

**文件**：`src/feature_processor.py`

**功能**：
- CSI特征提取和预处理
- RFF特征提取和预处理
- SNR计算和子载波选择
- 特征掩码生成

**实现要点**：
```python
class FeatureProcessor:
    - process_csi()：CSI特征处理
    - process_rff()：RFF特征处理
    - select_subcarriers()：子载波选择
    - generate_mask()：掩码生成
```

**预计时间**：4小时

### Task 2.3: 量化投票模块

**文件**：`src/quantizer.py`

**功能**：
- 多帧特征采集
- 门限计算（分位数/固定倍数）
- 三值量化
- 多数投票

**实现要点**：
```python
class FeatureQuantizer:
    - compute_thresholds()：计算门限
    - quantize_frame()：单帧量化
    - majority_vote()：多数投票
    - pad_bits()：比特补齐
```

**预计时间**：3小时

### Task 2.4: 模糊提取器模块

**文件**：`src/fuzzy_extractor.py`

**功能**：
- BCH编码（注册阶段）
- BCH解码（认证阶段）
- 辅助数据生成和存储
- 稳定特征串恢复

**实现要点**：
```python
class FuzzyExtractor:
    - generate_helper_data()：生成辅助数据
    - extract_stable_key()：提取稳定密钥
    - bch_encode()：BCH编码
    - bch_decode()：BCH解码
```

**依赖**：bchlib库

**预计时间**：4小时

### Task 2.5: 密钥派生模块

**文件**：`src/key_derivation.py`

**功能**：
- BLAKE3哈希
- HKDF密钥派生
- 上下文绑定
- 一致性摘要生成

**实现要点**：
```python
class KeyDerivation:
    - compute_L()：计算随机扰动值
    - derive_feature_key()：派生特征密钥
    - derive_session_key()：派生会话密钥
    - generate_digest()：生成一致性摘要
```

**依赖**：blake3库（或hashlib）、cryptography库

**预计时间**：3小时

### Task 2.6: 主流程整合

**文件**：`src/feature_encryption.py`

**功能**：
- 整合所有模块
- 提供统一接口
- 处理异常情况
- 日志记录

**实现要点**：
```python
class FeatureEncryption:
    - register()：注册阶段接口
    - authenticate()：认证阶段接口
    - feature_key_gen()：完整流程
```

**预计时间**：2小时

## 测试计划

### 单元测试（预计6小时）

#### test_config.py
- 测试配置验证
- 测试参数边界
- 测试配置加载

#### test_feature_processor.py
- 测试CSI特征提取
- 测试RFF特征提取
- 测试子载波选择
- 测试边界情况

#### test_quantizer.py
- 测试门限计算
- 测试量化逻辑
- 测试投票机制
- 测试比特补齐

#### test_fuzzy_extractor.py
- 测试BCH编解码
- 测试辅助数据生成
- 测试纠错能力
- 测试失败处理

#### test_key_derivation.py
- 测试HKDF正确性
- 测试digest生成
- 测试上下文绑定
- 测试确定性

### 集成测试（预计4小时）

#### test_integration.py
- 测试完整注册流程
- 测试完整认证流程
- 测试跨实现一致性
- 测试性能指标

### 性能测试（预计2小时）

#### test_performance.py
- 测试时延
- 测试吞吐量
- 测试内存占用
- 测试CPU占用

## 代码审查检查清单

### 功能正确性
- [ ] 所有算法步骤都已实现
- [ ] 公式与规范一致
- [ ] 边界情况处理完备
- [ ] 错误处理合理

### 代码质量
- [ ] 符合PEP 8规范
- [ ] 类型提示完整
- [ ] 文档字符串清晰
- [ ] 命名规范统一

### 安全性
- [ ] 无硬编码密钥
- [ ] 使用安全随机数
- [ ] 防止侧信道泄露
- [ ] 敏感数据清零

### 性能
- [ ] 无明显性能瓶颈
- [ ] 内存使用合理
- [ ] 可并行化的部分已优化
- [ ] 缓存机制合理

### 测试
- [ ] 测试覆盖率≥80%
- [ ] 所有测试通过
- [ ] 边界测试完整
- [ ] 性能测试达标

## 时间规划

| 阶段 | 任务 | 预计时间 | 实际时间 |
|------|------|---------|---------|
| 准备 | 文档编写 | 4h | ✅ |
| 实现 | 配置模块 | 2h | |
| 实现 | 特征处理 | 4h | |
| 实现 | 量化投票 | 3h | |
| 实现 | 模糊提取 | 4h | |
| 实现 | 密钥派生 | 3h | |
| 实现 | 主流程 | 2h | |
| 测试 | 单元测试 | 6h | |
| 测试 | 集成测试 | 4h | |
| 测试 | 性能测试 | 2h | |
| 审查 | 代码审查 | 3h | |
| 审查 | 优化文档 | 2h | |
| **总计** | | **39h** | |

## 里程碑

### M1: 文档完成（已完成✅）
- 算法分析报告
- 参数配置说明
- 算法完整规范
- 开发计划

### M2: 核心实现完成（目标：完成后2天）
- 所有6个模块实现
- 基本功能可运行
- 无明显bug

### M3: 测试完成（目标：M2后1天）
- 单元测试覆盖率≥80%
- 集成测试通过
- 性能达标

### M4: 审查完成（目标：M3后1天）
- 代码审查通过
- 文档完善
- 准备提交

## 风险与应对

### 风险1：BCH库兼容性问题
**概率**：中
**影响**：高
**应对**：预先测试bchlib，准备备选方案（Reed-Solomon码）

### 风险2：性能不达标
**概率**：低
**影响**：中
**应对**：提前进行性能测试，优化热点代码

### 风险3：测试覆盖率不足
**概率**：中
**影响**：中
**应对**：优先编写关键路径测试，使用coverage工具监控

## 下一步行动

1. ✅ 完成文档编写
2. 🔄 创建Python环境和安装依赖
3. ⏳ 实现配置管理模块
4. ⏳ 实现其他核心模块
5. ⏳ 编写测试用例
6. ⏳ 代码审查与优化
